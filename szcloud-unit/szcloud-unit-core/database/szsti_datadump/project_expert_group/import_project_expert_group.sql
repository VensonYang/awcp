#初始化项目分组INSERT INTO project_group_info(ID,GROUP_NAME, CREATE_USER, CREATE_TIME, REVIEW_TIME, PROJECT_TYPE,STATUS, SYSTEM_ID, HIGH_TECH_FIELD)SELECT ID,GROUP_NAME, 1, '2000-01-01', REVIEW_TIME,PROJECT_TYPE,10,87, HIGH_TECH_FIELD FROM temp_project_group_infoWHERE ID NOT IN(SELECT ID FROM project_group_info);#初始户项目分组－项目的对应关系；INSERT INTO project_project_group( PROJECT_GROUP_ID,PROJECT_ID, PROJECT_ORDER)SELECT PROJECT_GROUP_ID, PROJECT_ID,PROJECT_ORDER FROM temp_project_group_mapping aINNER JOIN temp_project_group_info b ON a.PROJECT_GROUP_ID = b.IDWHERE PROJECT_GROUP_ID NOT IN( '11e4-d2be-b1a16146-8f4b-595b24d42ff3','11e4-d2be-b1a16146-8f4b-595b24d42ff3')AND PROJECT_ID NOT IN (SELECT ID FROM temp_project_group_info);# LIMIT 10;SELECT PROJECT_GROUP_ID, PROJECT_ID ,COUNT(1) FROM temp_project_group_mapping aINNER JOIN temp_project_group_info b ON a.PROJECT_GROUP_ID = b.ID# LIMIT 10;GROUP BY PROJECT_GROUP_ID,PROJECT_ID HAVING COUNT(1) >1;#初始化专家分组;SELECT * FROM expert_group_info;INSERT INTO expert_group_info(ID, GROUP_NAME, CREATE_USER,CREATE_TIME,REVIEW_TIME, STATUS,SYSTEM_ID, GROUP_ORDER)SELECT ID, GROUP_NAME, 1,'2000-1-1',REVIEW_TIME,10,87, 0 FROM temp_expert_group_infoWHERE ID NOT IN(SELECT ID FROM expert_group_info);#初始化专家分组－专家的对应关系SELECT * FROM expert_expert_group;INSERT INTO expert_expert_group(EXPERT_ID, EXPERT_GROUP_ID)SELECT a.EXPERT_ID,a.EXPERT_GROUP_ID FROM temp_expert_group_mapping aINNER JOIN expert_base_info b ON a.EXPERT_ID = b.IDLEFT JOIN expert_expert_group c ON c.EXPERT_ID = a.EXPERT_ID AND c.EXPERT_GROUP_ID = a.EXPERT_GROUP_IDWHERE c.EXPERT_GROUP_ID IS NULL;#初始化项目专家分组与项目分组;SELECT *FROM project_expert_match;INSERT INTO project_expert_match(ID,PROJECT_GROUP_ID, EXPERT_GROUP_ID, CREATE_USER, CREATE_TIME, REVIEW_START_TIME, REVIEW_END_TIME,REVIEW_TABLE_NAME,STATUS, SYSTEM_ID)SELECT a.ID, a.ID, a.EXPERT_GROUP_ID,1,'2000-1-1',a.REVIEW_TIME,NULL,REVIEW_FORM_ID AS REVIEW_TABLE_NAME, 10, 87  FROM temp_project_group_info aINNER JOIN project_group_info b ON a.ID = b.ID LEFT JOIN project_expert_match m ON m.PROJECT_GROUP_ID = a.ID AND m.EXPERT_GROUP_ID = a.EXPERT_GROUP_IDWHERE m.PROJECT_GROUP_ID IS NULL AND a.EXPERT_GROUP_ID IS NOT NULL;#修改当日评审专家的密码－666666UPDATE p_un_user_base_infoSET USER_PWD = '359b0fb5e37287ce6a10e8f9f5ba6343866adfe7f6ea669d'WHERE USER_ID IN(SELECT c.USER_IDFROM expert_group_info aINNER JOIN expert_expert_group b ON a.ID = b.EXPERT_GROUP_ID LEFT JOIN expert_base_info c on c.ID = b.EXPERT_IDWHERE a.REVIEW_TIME = '2015-04-13')#如有新进专家，给专家赋评审的权限insert into p_un_user_role(USER_ID,ROLE_ID)SELECT a.USER_ID, 64 FROM p_un_user_base_info aWHERE a.GROUP_ID = 4 AND USER_ID NOT IN(SELECT USER_ID FROM p_un_user_role WHERE ROLE_ID = 64);#更新评审表UPDATE project_expert_match SET REVIEW_TABLE_NAME = 'hbzjpsb,27,' WHERE REVIEW_TABLE_NAME = '11e1-bb47-c33a102b-a0ff-9b2155608d05';UPDATE project_expert_match SET REVIEW_TABLE_NAME = 'hbzjpsb,19,' WHERE REVIEW_TABLE_NAME = '11e1-ede8-2a9ea18f-89b7-db2c8841f24f';UPDATE project_expert_match SET REVIEW_TABLE_NAME = 'hbzjpsb,30,' WHERE REVIEW_TABLE_NAME = '11e1-ede4-b1d63fd9-89b7-db2c8841f24f';UPDATE project_expert_match SET REVIEW_TABLE_NAME = 'hbzjpsb,13,' WHERE REVIEW_TABLE_NAME = '11e1-d531-aea4b86d-8cc7-7964e1ccdf53';